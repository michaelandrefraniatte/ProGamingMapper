using System;
using System.Collections.Generic;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using WebSocketSharp;

namespace PGMHost
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        public static string ip;
        public static string port;
        public static WebSocket wsc;
        public static string[] control;
        public static bool running = false;
        private static bool interception = false, km = false, xc = false, xcnumber1 = false, xcnumber2 = false, unloadxc = false, unloadkm = false, unloadint = false;
        public static int xcnumber = 0;
        public static Input input = new Input();
        public static int keyboard_1_id = 0, keyboard_2_id = 0, mouse_1_id = 0, mouse_2_id = 0;
        static double int_1_deltaX = 0; static double int_1_deltaY = 0; static double int_1_x = 0; static double int_1_y = 0; static bool int_1_SendLeftClick; static bool int_1_SendRightClick; static bool int_1_SendMiddleClick; static bool int_1_SendWheelUp; static bool int_1_SendWheelDown; static bool int_1_SendCANCEL; static bool int_1_SendBACK; static bool int_1_SendTAB; static bool int_1_SendCLEAR; static bool int_1_SendRETURN; static bool int_1_SendSHIFT; static bool int_1_SendCONTROL; static bool int_1_SendMENU; static bool int_1_SendCAPITAL; static bool int_1_SendESCAPE; static bool int_1_SendSPACE; static bool int_1_SendPRIOR; static bool int_1_SendNEXT; static bool int_1_SendEND; static bool int_1_SendHOME; static bool int_1_SendLEFT; static bool int_1_SendUP; static bool int_1_SendRIGHT; static bool int_1_SendDOWN; static bool int_1_SendSNAPSHOT; static bool int_1_SendINSERT; static bool int_1_SendNUMPADDEL; static bool int_1_SendNUMPADINSERT; static bool int_1_SendHELP; static bool int_1_SendAPOSTROPHE; static bool int_1_SendBACKSPACE; static bool int_1_SendPAGEDOWN; static bool int_1_SendPAGEUP; static bool int_1_SendFIN; static bool int_1_SendMOUSE; static bool int_1_SendA; static bool int_1_SendB; static bool int_1_SendC; static bool int_1_SendD; static bool int_1_SendE; static bool int_1_SendF; static bool int_1_SendG; static bool int_1_SendH; static bool int_1_SendI; static bool int_1_SendJ; static bool int_1_SendK; static bool int_1_SendL; static bool int_1_SendM; static bool int_1_SendN; static bool int_1_SendO; static bool int_1_SendP; static bool int_1_SendQ; static bool int_1_SendR; static bool int_1_SendS; static bool int_1_SendT; static bool int_1_SendU; static bool int_1_SendV; static bool int_1_SendW; static bool int_1_SendX; static bool int_1_SendY; static bool int_1_SendZ; static bool int_1_SendLWIN; static bool int_1_SendRWIN; static bool int_1_SendAPPS; static bool int_1_SendDELETE; static bool int_1_SendNUMPAD0; static bool int_1_SendNUMPAD1; static bool int_1_SendNUMPAD2; static bool int_1_SendNUMPAD3; static bool int_1_SendNUMPAD4; static bool int_1_SendNUMPAD5; static bool int_1_SendNUMPAD6; static bool int_1_SendNUMPAD7; static bool int_1_SendNUMPAD8; static bool int_1_SendNUMPAD9; static bool int_1_SendMULTIPLY; static bool int_1_SendADD; static bool int_1_SendSUBTRACT; static bool int_1_SendDECIMAL; static bool int_1_SendPRINTSCREEN; static bool int_1_SendDIVIDE; static bool int_1_SendF1; static bool int_1_SendF2; static bool int_1_SendF3; static bool int_1_SendF4; static bool int_1_SendF5; static bool int_1_SendF6; static bool int_1_SendF7; static bool int_1_SendF8; static bool int_1_SendF9; static bool int_1_SendF10; static bool int_1_SendF11; static bool int_1_SendF12; static bool int_1_SendNUMLOCK; static bool int_1_SendSCROLLLOCK; static bool int_1_SendLEFTSHIFT; static bool int_1_SendRIGHTSHIFT; static bool int_1_SendLEFTCONTROL; static bool int_1_SendRIGHTCONTROL; static bool int_1_SendLEFTALT; static bool int_1_SendRIGHTALT; static bool int_1_SendBROWSER_BACK; static bool int_1_SendBROWSER_FORWARD; static bool int_1_SendBROWSER_REFRESH; static bool int_1_SendBROWSER_STOP; static bool int_1_SendBROWSER_SEARCH; static bool int_1_SendBROWSER_FAVORITES; static bool int_1_SendBROWSER_HOME; static bool int_1_SendVOLUME_MUTE; static bool int_1_SendVOLUME_DOWN; static bool int_1_SendVOLUME_UP; static bool int_1_SendMEDIA_NEXT_TRACK; static bool int_1_SendMEDIA_PREV_TRACK; static bool int_1_SendMEDIA_STOP; static bool int_1_SendMEDIA_PLAY_PAUSE; static bool int_1_SendLAUNCH_MAIL; static bool int_1_SendLAUNCH_MEDIA_SELECT; static bool int_1_SendLAUNCH_APP1; static bool int_1_SendLAUNCH_APP2; static bool int_1_SendOEM_1; static bool int_1_SendOEM_PLUS; static bool int_1_SendOEM_COMMA; static bool int_1_SendOEM_MINUS; static bool int_1_SendOEM_PERIOD; static bool int_1_SendOEM_2; static bool int_1_SendOEM_3; static bool int_1_SendOEM_4; static bool int_1_SendOEM_5; static bool int_1_SendOEM_6; static bool int_1_SendOEM_7; static bool int_1_SendOEM_8; static bool int_1_SendOEM_102; static bool int_1_SendEREOF; static bool int_1_SendZOOM; static bool int_1_SendEscape; static bool int_1_SendOne; static bool int_1_SendTwo; static bool int_1_SendThree; static bool int_1_SendFour; static bool int_1_SendFive; static bool int_1_SendSix; static bool int_1_SendSeven; static bool int_1_SendEight; static bool int_1_SendNine; static bool int_1_SendZero; static bool int_1_SendDashUnderscore; static bool int_1_SendPlusEquals; static bool int_1_SendBackspace; static bool int_1_SendTab; static bool int_1_SendOpenBracketBrace; static bool int_1_SendCloseBracketBrace; static bool int_1_SendEnter; static bool int_1_SendControl; static bool int_1_SendSemicolonColon; static bool int_1_SendSingleDoubleQuote; static bool int_1_SendTilde; static bool int_1_SendLeftShift; static bool int_1_SendBackslashPipe; static bool int_1_SendCommaLeftArrow; static bool int_1_SendPeriodRightArrow; static bool int_1_SendForwardSlashQuestionMark; static bool int_1_SendRightShift; static bool int_1_SendRightAlt; static bool int_1_SendSpace; static bool int_1_SendCapsLock; static bool int_1_SendUp; static bool int_1_SendDown; static bool int_1_SendRight; static bool int_1_SendLeft; static bool int_1_SendHome; static bool int_1_SendEnd; static bool int_1_SendDelete; static bool int_1_SendPageUp; static bool int_1_SendPageDown; static bool int_1_SendInsert; static bool int_1_SendPrintScreen; static bool int_1_SendNumLock; static bool int_1_SendScrollLock; static bool int_1_SendMenu; static bool int_1_SendWindowsKey; static bool int_1_SendNumpadDivide; static bool int_1_SendNumpadAsterisk; static bool int_1_SendNumpad7; static bool int_1_SendNumpad8; static bool int_1_SendNumpad9; static bool int_1_SendNumpad4; static bool int_1_SendNumpad5; static bool int_1_SendNumpad6; static bool int_1_SendNumpad1; static bool int_1_SendNumpad2; static bool int_1_SendNumpad3; static bool int_1_SendNumpad0; static bool int_1_SendNumpadDelete; static bool int_1_SendNumpadEnter; static bool int_1_SendNumpadPlus; static bool int_1_SendNumpadMinus;
        static double int_2_deltaX = 0; static double int_2_deltaY = 0; static double int_2_x = 0; static double int_2_y = 0; static bool int_2_SendLeftClick; static bool int_2_SendRightClick; static bool int_2_SendMiddleClick; static bool int_2_SendWheelUp; static bool int_2_SendWheelDown; static bool int_2_SendCANCEL; static bool int_2_SendBACK; static bool int_2_SendTAB; static bool int_2_SendCLEAR; static bool int_2_SendRETURN; static bool int_2_SendSHIFT; static bool int_2_SendCONTROL; static bool int_2_SendMENU; static bool int_2_SendCAPITAL; static bool int_2_SendESCAPE; static bool int_2_SendSPACE; static bool int_2_SendPRIOR; static bool int_2_SendNEXT; static bool int_2_SendEND; static bool int_2_SendHOME; static bool int_2_SendLEFT; static bool int_2_SendUP; static bool int_2_SendRIGHT; static bool int_2_SendDOWN; static bool int_2_SendSNAPSHOT; static bool int_2_SendINSERT; static bool int_2_SendNUMPADDEL; static bool int_2_SendNUMPADINSERT; static bool int_2_SendHELP; static bool int_2_SendAPOSTROPHE; static bool int_2_SendBACKSPACE; static bool int_2_SendPAGEDOWN; static bool int_2_SendPAGEUP; static bool int_2_SendFIN; static bool int_2_SendMOUSE; static bool int_2_SendA; static bool int_2_SendB; static bool int_2_SendC; static bool int_2_SendD; static bool int_2_SendE; static bool int_2_SendF; static bool int_2_SendG; static bool int_2_SendH; static bool int_2_SendI; static bool int_2_SendJ; static bool int_2_SendK; static bool int_2_SendL; static bool int_2_SendM; static bool int_2_SendN; static bool int_2_SendO; static bool int_2_SendP; static bool int_2_SendQ; static bool int_2_SendR; static bool int_2_SendS; static bool int_2_SendT; static bool int_2_SendU; static bool int_2_SendV; static bool int_2_SendW; static bool int_2_SendX; static bool int_2_SendY; static bool int_2_SendZ; static bool int_2_SendLWIN; static bool int_2_SendRWIN; static bool int_2_SendAPPS; static bool int_2_SendDELETE; static bool int_2_SendNUMPAD0; static bool int_2_SendNUMPAD1; static bool int_2_SendNUMPAD2; static bool int_2_SendNUMPAD3; static bool int_2_SendNUMPAD4; static bool int_2_SendNUMPAD5; static bool int_2_SendNUMPAD6; static bool int_2_SendNUMPAD7; static bool int_2_SendNUMPAD8; static bool int_2_SendNUMPAD9; static bool int_2_SendMULTIPLY; static bool int_2_SendADD; static bool int_2_SendSUBTRACT; static bool int_2_SendDECIMAL; static bool int_2_SendPRINTSCREEN; static bool int_2_SendDIVIDE; static bool int_2_SendF1; static bool int_2_SendF2; static bool int_2_SendF3; static bool int_2_SendF4; static bool int_2_SendF5; static bool int_2_SendF6; static bool int_2_SendF7; static bool int_2_SendF8; static bool int_2_SendF9; static bool int_2_SendF10; static bool int_2_SendF11; static bool int_2_SendF12; static bool int_2_SendNUMLOCK; static bool int_2_SendSCROLLLOCK; static bool int_2_SendLEFTSHIFT; static bool int_2_SendRIGHTSHIFT; static bool int_2_SendLEFTCONTROL; static bool int_2_SendRIGHTCONTROL; static bool int_2_SendLEFTALT; static bool int_2_SendRIGHTALT; static bool int_2_SendBROWSER_BACK; static bool int_2_SendBROWSER_FORWARD; static bool int_2_SendBROWSER_REFRESH; static bool int_2_SendBROWSER_STOP; static bool int_2_SendBROWSER_SEARCH; static bool int_2_SendBROWSER_FAVORITES; static bool int_2_SendBROWSER_HOME; static bool int_2_SendVOLUME_MUTE; static bool int_2_SendVOLUME_DOWN; static bool int_2_SendVOLUME_UP; static bool int_2_SendMEDIA_NEXT_TRACK; static bool int_2_SendMEDIA_PREV_TRACK; static bool int_2_SendMEDIA_STOP; static bool int_2_SendMEDIA_PLAY_PAUSE; static bool int_2_SendLAUNCH_MAIL; static bool int_2_SendLAUNCH_MEDIA_SELECT; static bool int_2_SendLAUNCH_APP1; static bool int_2_SendLAUNCH_APP2; static bool int_2_SendOEM_1; static bool int_2_SendOEM_PLUS; static bool int_2_SendOEM_COMMA; static bool int_2_SendOEM_MINUS; static bool int_2_SendOEM_PERIOD; static bool int_2_SendOEM_2; static bool int_2_SendOEM_3; static bool int_2_SendOEM_4; static bool int_2_SendOEM_5; static bool int_2_SendOEM_6; static bool int_2_SendOEM_7; static bool int_2_SendOEM_8; static bool int_2_SendOEM_102; static bool int_2_SendEREOF; static bool int_2_SendZOOM; static bool int_2_SendEscape; static bool int_2_SendOne; static bool int_2_SendTwo; static bool int_2_SendThree; static bool int_2_SendFour; static bool int_2_SendFive; static bool int_2_SendSix; static bool int_2_SendSeven; static bool int_2_SendEight; static bool int_2_SendNine; static bool int_2_SendZero; static bool int_2_SendDashUnderscore; static bool int_2_SendPlusEquals; static bool int_2_SendBackspace; static bool int_2_SendTab; static bool int_2_SendOpenBracketBrace; static bool int_2_SendCloseBracketBrace; static bool int_2_SendEnter; static bool int_2_SendControl; static bool int_2_SendSemicolonColon; static bool int_2_SendSingleDoubleQuote; static bool int_2_SendTilde; static bool int_2_SendLeftShift; static bool int_2_SendBackslashPipe; static bool int_2_SendCommaLeftArrow; static bool int_2_SendPeriodRightArrow; static bool int_2_SendForwardSlashQuestionMark; static bool int_2_SendRightShift; static bool int_2_SendRightAlt; static bool int_2_SendSpace; static bool int_2_SendCapsLock; static bool int_2_SendUp; static bool int_2_SendDown; static bool int_2_SendRight; static bool int_2_SendLeft; static bool int_2_SendHome; static bool int_2_SendEnd; static bool int_2_SendDelete; static bool int_2_SendPageUp; static bool int_2_SendPageDown; static bool int_2_SendInsert; static bool int_2_SendPrintScreen; static bool int_2_SendNumLock; static bool int_2_SendScrollLock; static bool int_2_SendMenu; static bool int_2_SendWindowsKey; static bool int_2_SendNumpadDivide; static bool int_2_SendNumpadAsterisk; static bool int_2_SendNumpad7; static bool int_2_SendNumpad8; static bool int_2_SendNumpad9; static bool int_2_SendNumpad4; static bool int_2_SendNumpad5; static bool int_2_SendNumpad6; static bool int_2_SendNumpad1; static bool int_2_SendNumpad2; static bool int_2_SendNumpad3; static bool int_2_SendNumpad0; static bool int_2_SendNumpadDelete; static bool int_2_SendNumpadEnter; static bool int_2_SendNumpadPlus; static bool int_2_SendNumpadMinus;
        public static int[] wd = { 2, 2, 2, 2, 2, 2, 2, 2 };
        public static int[] wu = { 2, 2, 2, 2, 2, 2, 2, 2 };
        public static void valchanged(int n, bool val)
        {
            if (val)
            {
                if (wd[n] <= 1)
                {
                    wd[n] = wd[n] + 1;
                }
                wu[n] = 0;
            }
            else
            {
                if (wu[n] <= 1)
                {
                    wu[n] = wu[n] + 1;
                }
                wd[n] = 0;
            }
        }
        private void Form1_Load(object sender, EventArgs e)
        {
            if (System.IO.File.Exists("tempsave"))
            {
                using (System.IO.StreamReader file = new System.IO.StreamReader("tempsave"))
                {
                    textBox1.Text = file.ReadLine();
                    textBox2.Text = file.ReadLine();
                }
            }
            input.KeyboardFilterMode = KeyboardFilterMode.All;
            input.MouseFilterMode = MouseFilterMode.All;
            input.Load();
        }
        private void button1_Click(object sender, EventArgs e)
        {
            if (!running)
            {
                running = true;
                button1.Text = "Stop";
                ip = textBox1.Text;
                port = textBox2.Text;
                Task.Run(() => Connect());
            }
            else
            {
                running = false;
                button1.Text = "Start";
            }
        }
        public static void Connect()
        {
            System.Threading.Thread.Sleep(2000);
            String connectionString = "ws://" + ip + ":" + port + "/Control";
            wsc = new WebSocket(connectionString);
            wsc.OnMessage += Ws_OnMessage;
            while (!wsc.IsAlive & running)
            {
                try
                {
                    wsc.Connect();
                    wsc.Send("Hello from client");
                }
                catch { }
                System.Threading.Thread.Sleep(1);
            }
            while (wsc.IsAlive & running)
            {
                System.Threading.Thread.Sleep(1);
            }
            try
            {
                Disconnect();
                if (running)
                    Task.Run(() => Connect());
            } 
            catch { }
        }
        public static void Disconnect()
        {
            wsc.OnMessage -= Ws_OnMessage;
            wsc.Close();
            if (xc)
                Scp.UnLoadControllers();
            if (km)
                SendKeyboard.UnLoadKM();
            if (interception)
                SendInterception.UnLoadKM(input, keyboard_1_id, mouse_1_id, keyboard_2_id, mouse_2_id);
            xc = false;
            km = false;
            interception = false;
            xcnumber1 = false;
            xcnumber2 = false;
            xcnumber = 0;
            valchanged(0, xcnumber1 & xc);
            valchanged(1, xcnumber2 & xc);
        }
        private static void Ws_OnMessage(object sender, MessageEventArgs e)
        {
            control = byteArrayToControl(e.RawData);
            try
            {
                km = bool.Parse(control[0]);
                xc = bool.Parse(control[1]);
                xcnumber1 = bool.Parse(control[2]);
                valchanged(0, xcnumber1 & xc);
                if (wd[0] == 1)
                {
                    xcnumber = 1;
                    Scp.LoadControllers();
                }
                xcnumber2 = bool.Parse(control[3]);
                valchanged(1, xcnumber2 & xc);
                if (wd[1] == 1)
                {
                    xcnumber = 2;
                    Scp.LoadControllers();
                }
                string KeyboardMouseDriverType = control[4];
                bool SendLeftClick = bool.Parse(control[5]); bool SendRightClick = bool.Parse(control[6]); bool SendMiddleClick = bool.Parse(control[7]); bool SendWheelUp = bool.Parse(control[8]); bool SendWheelDown = bool.Parse(control[9]); bool SendLeft = bool.Parse(control[10]); bool SendRight = bool.Parse(control[11]); bool SendUp = bool.Parse(control[12]); bool SendDown = bool.Parse(control[13]); bool SendLButton = bool.Parse(control[14]); bool SendRButton = bool.Parse(control[15]); bool SendCancel = bool.Parse(control[16]); bool SendMBUTTON = bool.Parse(control[17]); bool SendXBUTTON1 = bool.Parse(control[18]); bool SendXBUTTON2 = bool.Parse(control[19]); bool SendBack = bool.Parse(control[20]); bool SendTab = bool.Parse(control[21]); bool SendClear = bool.Parse(control[22]); bool SendReturn = bool.Parse(control[23]); bool SendSHIFT = bool.Parse(control[24]); bool SendCONTROL = bool.Parse(control[25]); bool SendMENU = bool.Parse(control[26]); bool SendPAUSE = bool.Parse(control[27]); bool SendCAPITAL = bool.Parse(control[28]); bool SendKANA = bool.Parse(control[29]); bool SendHANGEUL = bool.Parse(control[30]); bool SendHANGUL = bool.Parse(control[31]); bool SendJUNJA = bool.Parse(control[32]); bool SendFINAL = bool.Parse(control[33]); bool SendHANJA = bool.Parse(control[34]); bool SendKANJI = bool.Parse(control[35]); bool SendEscape = bool.Parse(control[36]); bool SendCONVERT = bool.Parse(control[37]); bool SendNONCONVERT = bool.Parse(control[38]); bool SendACCEPT = bool.Parse(control[39]); bool SendMODECHANGE = bool.Parse(control[40]); bool SendSpace = bool.Parse(control[41]); bool SendPRIOR = bool.Parse(control[42]); bool SendNEXT = bool.Parse(control[43]); bool SendEND = bool.Parse(control[44]); bool SendHOME = bool.Parse(control[45]); bool SendLEFT = bool.Parse(control[46]); bool SendUP = bool.Parse(control[47]); bool SendRIGHT = bool.Parse(control[48]); bool SendDOWN = bool.Parse(control[49]); bool SendSELECT = bool.Parse(control[50]); bool SendPRINT = bool.Parse(control[51]); bool SendEXECUTE = bool.Parse(control[52]); bool SendSNAPSHOT = bool.Parse(control[53]); bool SendINSERT = bool.Parse(control[54]); bool SendDELETE = bool.Parse(control[55]); bool SendHELP = bool.Parse(control[56]); bool SendAPOSTROPHE = bool.Parse(control[57]); bool Send0 = bool.Parse(control[58]); bool Send1 = bool.Parse(control[59]); bool Send2 = bool.Parse(control[60]); bool Send3 = bool.Parse(control[61]); bool Send4 = bool.Parse(control[62]); bool Send5 = bool.Parse(control[63]); bool Send6 = bool.Parse(control[64]); bool Send7 = bool.Parse(control[65]); bool Send8 = bool.Parse(control[66]); bool Send9 = bool.Parse(control[67]); bool SendA = bool.Parse(control[68]); bool SendB = bool.Parse(control[69]); bool SendC = bool.Parse(control[70]); bool SendD = bool.Parse(control[71]); bool SendE = bool.Parse(control[72]); bool SendF = bool.Parse(control[73]); bool SendG = bool.Parse(control[74]); bool SendH = bool.Parse(control[75]); bool SendI = bool.Parse(control[76]); bool SendJ = bool.Parse(control[77]); bool SendK = bool.Parse(control[78]); bool SendL = bool.Parse(control[79]); bool SendM = bool.Parse(control[80]); bool SendN = bool.Parse(control[81]); bool SendO = bool.Parse(control[82]); bool SendP = bool.Parse(control[83]); bool SendQ = bool.Parse(control[84]); bool SendR = bool.Parse(control[85]); bool SendS = bool.Parse(control[86]); bool SendT = bool.Parse(control[87]); bool SendU = bool.Parse(control[88]); bool SendV = bool.Parse(control[89]); bool SendW = bool.Parse(control[90]); bool SendX = bool.Parse(control[91]); bool SendY = bool.Parse(control[92]); bool SendZ = bool.Parse(control[93]); bool SendLWIN = bool.Parse(control[94]); bool SendRWIN = bool.Parse(control[95]); bool SendAPPS = bool.Parse(control[96]); bool SendSLEEP = bool.Parse(control[97]); bool SendNUMPAD0 = bool.Parse(control[98]); bool SendNUMPAD1 = bool.Parse(control[99]); bool SendNUMPAD2 = bool.Parse(control[100]); bool SendNUMPAD3 = bool.Parse(control[101]); bool SendNUMPAD4 = bool.Parse(control[102]); bool SendNUMPAD5 = bool.Parse(control[103]); bool SendNUMPAD6 = bool.Parse(control[104]); bool SendNUMPAD7 = bool.Parse(control[105]); bool SendNUMPAD8 = bool.Parse(control[106]); bool SendNUMPAD9 = bool.Parse(control[107]); bool SendMULTIPLY = bool.Parse(control[108]); bool SendADD = bool.Parse(control[109]); bool SendSEPARATOR = bool.Parse(control[110]); bool SendSUBTRACT = bool.Parse(control[111]); bool SendDECIMAL = bool.Parse(control[112]); bool SendDIVIDE = bool.Parse(control[113]); bool SendF1 = bool.Parse(control[114]); bool SendF2 = bool.Parse(control[115]); bool SendF3 = bool.Parse(control[116]); bool SendF4 = bool.Parse(control[117]); bool SendF5 = bool.Parse(control[118]); bool SendF6 = bool.Parse(control[119]); bool SendF7 = bool.Parse(control[120]); bool SendF8 = bool.Parse(control[121]); bool SendF9 = bool.Parse(control[122]); bool SendF10 = bool.Parse(control[123]); bool SendF11 = bool.Parse(control[124]); bool SendF12 = bool.Parse(control[125]); bool SendF13 = bool.Parse(control[126]); bool SendF14 = bool.Parse(control[127]); bool SendF15 = bool.Parse(control[128]); bool SendF16 = bool.Parse(control[129]); bool SendF17 = bool.Parse(control[130]); bool SendF18 = bool.Parse(control[131]); bool SendF19 = bool.Parse(control[132]); bool SendF20 = bool.Parse(control[133]); bool SendF21 = bool.Parse(control[134]); bool SendF22 = bool.Parse(control[135]); bool SendF23 = bool.Parse(control[136]); bool SendF24 = bool.Parse(control[137]); bool SendNUMLOCK = bool.Parse(control[138]); bool SendSCROLL = bool.Parse(control[139]); bool SendLeftShift = bool.Parse(control[140]); bool SendRightShift = bool.Parse(control[141]); bool SendLeftControl = bool.Parse(control[142]); bool SendRightControl = bool.Parse(control[143]); bool SendLMENU = bool.Parse(control[144]); bool SendRMENU = bool.Parse(control[145]);
                double MouseMoveX = Convert.ToSingle(control[146]);
                double MouseMoveY = Convert.ToSingle(control[147]);
                double MouseAbsX = Convert.ToSingle(control[148]);
                double MouseAbsY = Convert.ToSingle(control[149]);
                double MouseDesktopX = Convert.ToSingle(control[150]);
                double MouseDesktopY = Convert.ToSingle(control[151]);
                bool controller1_send_back = bool.Parse(control[152]); bool controller1_send_start = bool.Parse(control[153]); bool controller1_send_A = bool.Parse(control[154]); bool controller1_send_B = bool.Parse(control[155]); bool controller1_send_X = bool.Parse(control[156]); bool controller1_send_Y = bool.Parse(control[157]); bool controller1_send_up = bool.Parse(control[158]); bool controller1_send_left = bool.Parse(control[159]); bool controller1_send_down = bool.Parse(control[160]); bool controller1_send_right = bool.Parse(control[161]); bool controller1_send_leftstick = bool.Parse(control[162]); bool controller1_send_rightstick = bool.Parse(control[163]); bool controller1_send_leftbumper = bool.Parse(control[164]); bool controller1_send_rightbumper = bool.Parse(control[165]); bool controller1_send_lefttrigger = bool.Parse(control[166]); bool controller1_send_righttrigger = bool.Parse(control[167]); double controller1_send_leftstickx = Convert.ToSingle(control[168]); double controller1_send_leftsticky = Convert.ToSingle(control[169]); double controller1_send_rightstickx = Convert.ToSingle(control[170]); double controller1_send_rightsticky = Convert.ToSingle(control[171]); bool controller2_send_back = bool.Parse(control[172]); bool controller2_send_start = bool.Parse(control[173]); bool controller2_send_A = bool.Parse(control[174]); bool controller2_send_B = bool.Parse(control[175]); bool controller2_send_X = bool.Parse(control[176]); bool controller2_send_Y = bool.Parse(control[177]); bool controller2_send_up = bool.Parse(control[178]); bool controller2_send_left = bool.Parse(control[179]); bool controller2_send_down = bool.Parse(control[180]); bool controller2_send_right = bool.Parse(control[181]); bool controller2_send_leftstick = bool.Parse(control[182]); bool controller2_send_rightstick = bool.Parse(control[183]); bool controller2_send_leftbumper = bool.Parse(control[184]); bool controller2_send_rightbumper = bool.Parse(control[185]); bool controller2_send_lefttrigger = bool.Parse(control[186]); bool controller2_send_righttrigger = bool.Parse(control[187]); double controller2_send_leftstickx = Convert.ToSingle(control[188]); double controller2_send_leftsticky = Convert.ToSingle(control[189]); double controller2_send_rightstickx = Convert.ToSingle(control[190]); double controller2_send_rightsticky = Convert.ToSingle(control[191]); double controller1_send_lefttriggerposition = Convert.ToSingle(control[192]); double controller1_send_righttriggerposition = Convert.ToSingle(control[193]); double controller2_send_lefttriggerposition = Convert.ToSingle(control[194]); double controller2_send_righttriggerposition = Convert.ToSingle(control[195]); bool controller1_send_xbox = bool.Parse(control[196]); bool controller2_send_xbox = bool.Parse(control[197]);
                unloadxc = bool.Parse(control[198]); unloadkm = bool.Parse(control[199]);
                interception = bool.Parse(control[200]); unloadint = bool.Parse(control[201]);
                if (interception)
                {
                    MouseDesktopX = Convert.ToSingle(control[202]);
                    MouseDesktopY = Convert.ToSingle(control[203]);
                }
                keyboard_1_id = int.Parse(control[204]); mouse_1_id = int.Parse(control[205]);
                int_1_deltaX = Convert.ToSingle(control[206]); int_1_deltaY = Convert.ToSingle(control[207]); int_1_x = Convert.ToSingle(control[208]); int_1_y = Convert.ToSingle(control[209]);
                int i = 210;
                int_1_SendLeftClick = bool.Parse(control[i++]); int_1_SendRightClick = bool.Parse(control[i++]); int_1_SendMiddleClick = bool.Parse(control[i++]); int_1_SendWheelUp = bool.Parse(control[i++]); int_1_SendWheelDown = bool.Parse(control[i++]); int_1_SendCANCEL = bool.Parse(control[i++]); int_1_SendBACK = bool.Parse(control[i++]); int_1_SendTAB = bool.Parse(control[i++]); int_1_SendCLEAR = bool.Parse(control[i++]); int_1_SendRETURN = bool.Parse(control[i++]); int_1_SendSHIFT = bool.Parse(control[i++]); int_1_SendCONTROL = bool.Parse(control[i++]); int_1_SendMENU = bool.Parse(control[i++]); int_1_SendCAPITAL = bool.Parse(control[i++]); int_1_SendESCAPE = bool.Parse(control[i++]); int_1_SendSPACE = bool.Parse(control[i++]); int_1_SendPRIOR = bool.Parse(control[i++]); int_1_SendNEXT = bool.Parse(control[i++]); int_1_SendEND = bool.Parse(control[i++]); int_1_SendHOME = bool.Parse(control[i++]); int_1_SendLEFT = bool.Parse(control[i++]); int_1_SendUP = bool.Parse(control[i++]); int_1_SendRIGHT = bool.Parse(control[i++]); int_1_SendDOWN = bool.Parse(control[i++]); int_1_SendSNAPSHOT = bool.Parse(control[i++]); int_1_SendINSERT = bool.Parse(control[i++]); int_1_SendNUMPADDEL = bool.Parse(control[i++]); int_1_SendNUMPADINSERT = bool.Parse(control[i++]); int_1_SendHELP = bool.Parse(control[i++]); int_1_SendAPOSTROPHE = bool.Parse(control[i++]); int_1_SendBACKSPACE = bool.Parse(control[i++]); int_1_SendPAGEDOWN = bool.Parse(control[i++]); int_1_SendPAGEUP = bool.Parse(control[i++]); int_1_SendFIN = bool.Parse(control[i++]); int_1_SendMOUSE = bool.Parse(control[i++]); int_1_SendA = bool.Parse(control[i++]); int_1_SendB = bool.Parse(control[i++]); int_1_SendC = bool.Parse(control[i++]); int_1_SendD = bool.Parse(control[i++]); int_1_SendE = bool.Parse(control[i++]); int_1_SendF = bool.Parse(control[i++]); int_1_SendG = bool.Parse(control[i++]); int_1_SendH = bool.Parse(control[i++]); int_1_SendI = bool.Parse(control[i++]); int_1_SendJ = bool.Parse(control[i++]); int_1_SendK = bool.Parse(control[i++]); int_1_SendL = bool.Parse(control[i++]); int_1_SendM = bool.Parse(control[i++]); int_1_SendN = bool.Parse(control[i++]); int_1_SendO = bool.Parse(control[i++]); int_1_SendP = bool.Parse(control[i++]); int_1_SendQ = bool.Parse(control[i++]); int_1_SendR = bool.Parse(control[i++]); int_1_SendS = bool.Parse(control[i++]); int_1_SendT = bool.Parse(control[i++]); int_1_SendU = bool.Parse(control[i++]); int_1_SendV = bool.Parse(control[i++]); int_1_SendW = bool.Parse(control[i++]); int_1_SendX = bool.Parse(control[i++]); int_1_SendY = bool.Parse(control[i++]); int_1_SendZ = bool.Parse(control[i++]); int_1_SendLWIN = bool.Parse(control[i++]); int_1_SendRWIN = bool.Parse(control[i++]); int_1_SendAPPS = bool.Parse(control[i++]); int_1_SendDELETE = bool.Parse(control[i++]); int_1_SendNUMPAD0 = bool.Parse(control[i++]); int_1_SendNUMPAD1 = bool.Parse(control[i++]); int_1_SendNUMPAD2 = bool.Parse(control[i++]); int_1_SendNUMPAD3 = bool.Parse(control[i++]); int_1_SendNUMPAD4 = bool.Parse(control[i++]); int_1_SendNUMPAD5 = bool.Parse(control[i++]); int_1_SendNUMPAD6 = bool.Parse(control[i++]); int_1_SendNUMPAD7 = bool.Parse(control[i++]); int_1_SendNUMPAD8 = bool.Parse(control[i++]); int_1_SendNUMPAD9 = bool.Parse(control[i++]); int_1_SendMULTIPLY = bool.Parse(control[i++]); int_1_SendADD = bool.Parse(control[i++]); int_1_SendSUBTRACT = bool.Parse(control[i++]); int_1_SendDECIMAL = bool.Parse(control[i++]); int_1_SendPRINTSCREEN = bool.Parse(control[i++]); int_1_SendDIVIDE = bool.Parse(control[i++]); int_1_SendF1 = bool.Parse(control[i++]); int_1_SendF2 = bool.Parse(control[i++]); int_1_SendF3 = bool.Parse(control[i++]); int_1_SendF4 = bool.Parse(control[i++]); int_1_SendF5 = bool.Parse(control[i++]); int_1_SendF6 = bool.Parse(control[i++]); int_1_SendF7 = bool.Parse(control[i++]); int_1_SendF8 = bool.Parse(control[i++]); int_1_SendF9 = bool.Parse(control[i++]); int_1_SendF10 = bool.Parse(control[i++]); int_1_SendF11 = bool.Parse(control[i++]); int_1_SendF12 = bool.Parse(control[i++]); int_1_SendNUMLOCK = bool.Parse(control[i++]); int_1_SendSCROLLLOCK = bool.Parse(control[i++]); int_1_SendLEFTSHIFT = bool.Parse(control[i++]); int_1_SendRIGHTSHIFT = bool.Parse(control[i++]); int_1_SendLEFTCONTROL = bool.Parse(control[i++]); int_1_SendRIGHTCONTROL = bool.Parse(control[i++]); int_1_SendLEFTALT = bool.Parse(control[i++]); int_1_SendRIGHTALT = bool.Parse(control[i++]); int_1_SendBROWSER_BACK = bool.Parse(control[i++]); int_1_SendBROWSER_FORWARD = bool.Parse(control[i++]); int_1_SendBROWSER_REFRESH = bool.Parse(control[i++]); int_1_SendBROWSER_STOP = bool.Parse(control[i++]); int_1_SendBROWSER_SEARCH = bool.Parse(control[i++]); int_1_SendBROWSER_FAVORITES = bool.Parse(control[i++]); int_1_SendBROWSER_HOME = bool.Parse(control[i++]); int_1_SendVOLUME_MUTE = bool.Parse(control[i++]); int_1_SendVOLUME_DOWN = bool.Parse(control[i++]); int_1_SendVOLUME_UP = bool.Parse(control[i++]); int_1_SendMEDIA_NEXT_TRACK = bool.Parse(control[i++]); int_1_SendMEDIA_PREV_TRACK = bool.Parse(control[i++]); int_1_SendMEDIA_STOP = bool.Parse(control[i++]); int_1_SendMEDIA_PLAY_PAUSE = bool.Parse(control[i++]); int_1_SendLAUNCH_MAIL = bool.Parse(control[i++]); int_1_SendLAUNCH_MEDIA_SELECT = bool.Parse(control[i++]); int_1_SendLAUNCH_APP1 = bool.Parse(control[i++]); int_1_SendLAUNCH_APP2 = bool.Parse(control[i++]); int_1_SendOEM_1 = bool.Parse(control[i++]); int_1_SendOEM_PLUS = bool.Parse(control[i++]); int_1_SendOEM_COMMA = bool.Parse(control[i++]); int_1_SendOEM_MINUS = bool.Parse(control[i++]); int_1_SendOEM_PERIOD = bool.Parse(control[i++]); int_1_SendOEM_2 = bool.Parse(control[i++]); int_1_SendOEM_3 = bool.Parse(control[i++]); int_1_SendOEM_4 = bool.Parse(control[i++]); int_1_SendOEM_5 = bool.Parse(control[i++]); int_1_SendOEM_6 = bool.Parse(control[i++]); int_1_SendOEM_7 = bool.Parse(control[i++]); int_1_SendOEM_8 = bool.Parse(control[i++]); int_1_SendOEM_102 = bool.Parse(control[i++]); int_1_SendEREOF = bool.Parse(control[i++]); int_1_SendZOOM = bool.Parse(control[i++]); int_1_SendEscape = bool.Parse(control[i++]); int_1_SendOne = bool.Parse(control[i++]); int_1_SendTwo = bool.Parse(control[i++]); int_1_SendThree = bool.Parse(control[i++]); int_1_SendFour = bool.Parse(control[i++]); int_1_SendFive = bool.Parse(control[i++]); int_1_SendSix = bool.Parse(control[i++]); int_1_SendSeven = bool.Parse(control[i++]); int_1_SendEight = bool.Parse(control[i++]); int_1_SendNine = bool.Parse(control[i++]); int_1_SendZero = bool.Parse(control[i++]); int_1_SendDashUnderscore = bool.Parse(control[i++]); int_1_SendPlusEquals = bool.Parse(control[i++]); int_1_SendBackspace = bool.Parse(control[i++]); int_1_SendTab = bool.Parse(control[i++]); int_1_SendOpenBracketBrace = bool.Parse(control[i++]); int_1_SendCloseBracketBrace = bool.Parse(control[i++]); int_1_SendEnter = bool.Parse(control[i++]); int_1_SendControl = bool.Parse(control[i++]); int_1_SendSemicolonColon = bool.Parse(control[i++]); int_1_SendSingleDoubleQuote = bool.Parse(control[i++]); int_1_SendTilde = bool.Parse(control[i++]); int_1_SendLeftShift = bool.Parse(control[i++]); int_1_SendBackslashPipe = bool.Parse(control[i++]); int_1_SendCommaLeftArrow = bool.Parse(control[i++]); int_1_SendPeriodRightArrow = bool.Parse(control[i++]); int_1_SendForwardSlashQuestionMark = bool.Parse(control[i++]); int_1_SendRightShift = bool.Parse(control[i++]); int_1_SendRightAlt = bool.Parse(control[i++]); int_1_SendSpace = bool.Parse(control[i++]); int_1_SendCapsLock = bool.Parse(control[i++]); int_1_SendUp = bool.Parse(control[i++]); int_1_SendDown = bool.Parse(control[i++]); int_1_SendRight = bool.Parse(control[i++]); int_1_SendLeft = bool.Parse(control[i++]); int_1_SendHome = bool.Parse(control[i++]); int_1_SendEnd = bool.Parse(control[i++]); int_1_SendDelete = bool.Parse(control[i++]); int_1_SendPageUp = bool.Parse(control[i++]); int_1_SendPageDown = bool.Parse(control[i++]); int_1_SendInsert = bool.Parse(control[i++]); int_1_SendPrintScreen = bool.Parse(control[i++]); int_1_SendNumLock = bool.Parse(control[i++]); int_1_SendScrollLock = bool.Parse(control[i++]); int_1_SendMenu = bool.Parse(control[i++]); int_1_SendWindowsKey = bool.Parse(control[i++]); int_1_SendNumpadDivide = bool.Parse(control[i++]); int_1_SendNumpadAsterisk = bool.Parse(control[i++]); int_1_SendNumpad7 = bool.Parse(control[i++]); int_1_SendNumpad8 = bool.Parse(control[i++]); int_1_SendNumpad9 = bool.Parse(control[i++]); int_1_SendNumpad4 = bool.Parse(control[i++]); int_1_SendNumpad5 = bool.Parse(control[i++]); int_1_SendNumpad6 = bool.Parse(control[i++]); int_1_SendNumpad1 = bool.Parse(control[i++]); int_1_SendNumpad2 = bool.Parse(control[i++]); int_1_SendNumpad3 = bool.Parse(control[i++]); int_1_SendNumpad0 = bool.Parse(control[i++]); int_1_SendNumpadDelete = bool.Parse(control[i++]); int_1_SendNumpadEnter = bool.Parse(control[i++]); int_1_SendNumpadPlus = bool.Parse(control[i++]); int_1_SendNumpadMinus = bool.Parse(control[i++]);
                keyboard_2_id = int.Parse(control[i++]); mouse_2_id = int.Parse(control[i++]);
                int_2_deltaX = Convert.ToSingle(control[i++]); int_2_deltaY = Convert.ToSingle(control[i++]); int_2_x = Convert.ToSingle(control[i++]); int_2_y = Convert.ToSingle(control[i++]);
                int_2_SendLeftClick = bool.Parse(control[i++]); int_2_SendRightClick = bool.Parse(control[i++]); int_2_SendMiddleClick = bool.Parse(control[i++]); int_2_SendWheelUp = bool.Parse(control[i++]); int_2_SendWheelDown = bool.Parse(control[i++]); int_2_SendCANCEL = bool.Parse(control[i++]); int_2_SendBACK = bool.Parse(control[i++]); int_2_SendTAB = bool.Parse(control[i++]); int_2_SendCLEAR = bool.Parse(control[i++]); int_2_SendRETURN = bool.Parse(control[i++]); int_2_SendSHIFT = bool.Parse(control[i++]); int_2_SendCONTROL = bool.Parse(control[i++]); int_2_SendMENU = bool.Parse(control[i++]); int_2_SendCAPITAL = bool.Parse(control[i++]); int_2_SendESCAPE = bool.Parse(control[i++]); int_2_SendSPACE = bool.Parse(control[i++]); int_2_SendPRIOR = bool.Parse(control[i++]); int_2_SendNEXT = bool.Parse(control[i++]); int_2_SendEND = bool.Parse(control[i++]); int_2_SendHOME = bool.Parse(control[i++]); int_2_SendLEFT = bool.Parse(control[i++]); int_2_SendUP = bool.Parse(control[i++]); int_2_SendRIGHT = bool.Parse(control[i++]); int_2_SendDOWN = bool.Parse(control[i++]); int_2_SendSNAPSHOT = bool.Parse(control[i++]); int_2_SendINSERT = bool.Parse(control[i++]); int_2_SendNUMPADDEL = bool.Parse(control[i++]); int_2_SendNUMPADINSERT = bool.Parse(control[i++]); int_2_SendHELP = bool.Parse(control[i++]); int_2_SendAPOSTROPHE = bool.Parse(control[i++]); int_2_SendBACKSPACE = bool.Parse(control[i++]); int_2_SendPAGEDOWN = bool.Parse(control[i++]); int_2_SendPAGEUP = bool.Parse(control[i++]); int_2_SendFIN = bool.Parse(control[i++]); int_2_SendMOUSE = bool.Parse(control[i++]); int_2_SendA = bool.Parse(control[i++]); int_2_SendB = bool.Parse(control[i++]); int_2_SendC = bool.Parse(control[i++]); int_2_SendD = bool.Parse(control[i++]); int_2_SendE = bool.Parse(control[i++]); int_2_SendF = bool.Parse(control[i++]); int_2_SendG = bool.Parse(control[i++]); int_2_SendH = bool.Parse(control[i++]); int_2_SendI = bool.Parse(control[i++]); int_2_SendJ = bool.Parse(control[i++]); int_2_SendK = bool.Parse(control[i++]); int_2_SendL = bool.Parse(control[i++]); int_2_SendM = bool.Parse(control[i++]); int_2_SendN = bool.Parse(control[i++]); int_2_SendO = bool.Parse(control[i++]); int_2_SendP = bool.Parse(control[i++]); int_2_SendQ = bool.Parse(control[i++]); int_2_SendR = bool.Parse(control[i++]); int_2_SendS = bool.Parse(control[i++]); int_2_SendT = bool.Parse(control[i++]); int_2_SendU = bool.Parse(control[i++]); int_2_SendV = bool.Parse(control[i++]); int_2_SendW = bool.Parse(control[i++]); int_2_SendX = bool.Parse(control[i++]); int_2_SendY = bool.Parse(control[i++]); int_2_SendZ = bool.Parse(control[i++]); int_2_SendLWIN = bool.Parse(control[i++]); int_2_SendRWIN = bool.Parse(control[i++]); int_2_SendAPPS = bool.Parse(control[i++]); int_2_SendDELETE = bool.Parse(control[i++]); int_2_SendNUMPAD0 = bool.Parse(control[i++]); int_2_SendNUMPAD1 = bool.Parse(control[i++]); int_2_SendNUMPAD2 = bool.Parse(control[i++]); int_2_SendNUMPAD3 = bool.Parse(control[i++]); int_2_SendNUMPAD4 = bool.Parse(control[i++]); int_2_SendNUMPAD5 = bool.Parse(control[i++]); int_2_SendNUMPAD6 = bool.Parse(control[i++]); int_2_SendNUMPAD7 = bool.Parse(control[i++]); int_2_SendNUMPAD8 = bool.Parse(control[i++]); int_2_SendNUMPAD9 = bool.Parse(control[i++]); int_2_SendMULTIPLY = bool.Parse(control[i++]); int_2_SendADD = bool.Parse(control[i++]); int_2_SendSUBTRACT = bool.Parse(control[i++]); int_2_SendDECIMAL = bool.Parse(control[i++]); int_2_SendPRINTSCREEN = bool.Parse(control[i++]); int_2_SendDIVIDE = bool.Parse(control[i++]); int_2_SendF1 = bool.Parse(control[i++]); int_2_SendF2 = bool.Parse(control[i++]); int_2_SendF3 = bool.Parse(control[i++]); int_2_SendF4 = bool.Parse(control[i++]); int_2_SendF5 = bool.Parse(control[i++]); int_2_SendF6 = bool.Parse(control[i++]); int_2_SendF7 = bool.Parse(control[i++]); int_2_SendF8 = bool.Parse(control[i++]); int_2_SendF9 = bool.Parse(control[i++]); int_2_SendF10 = bool.Parse(control[i++]); int_2_SendF11 = bool.Parse(control[i++]); int_2_SendF12 = bool.Parse(control[i++]); int_2_SendNUMLOCK = bool.Parse(control[i++]); int_2_SendSCROLLLOCK = bool.Parse(control[i++]); int_2_SendLEFTSHIFT = bool.Parse(control[i++]); int_2_SendRIGHTSHIFT = bool.Parse(control[i++]); int_2_SendLEFTCONTROL = bool.Parse(control[i++]); int_2_SendRIGHTCONTROL = bool.Parse(control[i++]); int_2_SendLEFTALT = bool.Parse(control[i++]); int_2_SendRIGHTALT = bool.Parse(control[i++]); int_2_SendBROWSER_BACK = bool.Parse(control[i++]); int_2_SendBROWSER_FORWARD = bool.Parse(control[i++]); int_2_SendBROWSER_REFRESH = bool.Parse(control[i++]); int_2_SendBROWSER_STOP = bool.Parse(control[i++]); int_2_SendBROWSER_SEARCH = bool.Parse(control[i++]); int_2_SendBROWSER_FAVORITES = bool.Parse(control[i++]); int_2_SendBROWSER_HOME = bool.Parse(control[i++]); int_2_SendVOLUME_MUTE = bool.Parse(control[i++]); int_2_SendVOLUME_DOWN = bool.Parse(control[i++]); int_2_SendVOLUME_UP = bool.Parse(control[i++]); int_2_SendMEDIA_NEXT_TRACK = bool.Parse(control[i++]); int_2_SendMEDIA_PREV_TRACK = bool.Parse(control[i++]); int_2_SendMEDIA_STOP = bool.Parse(control[i++]); int_2_SendMEDIA_PLAY_PAUSE = bool.Parse(control[i++]); int_2_SendLAUNCH_MAIL = bool.Parse(control[i++]); int_2_SendLAUNCH_MEDIA_SELECT = bool.Parse(control[i++]); int_2_SendLAUNCH_APP1 = bool.Parse(control[i++]); int_2_SendLAUNCH_APP2 = bool.Parse(control[i++]); int_2_SendOEM_1 = bool.Parse(control[i++]); int_2_SendOEM_PLUS = bool.Parse(control[i++]); int_2_SendOEM_COMMA = bool.Parse(control[i++]); int_2_SendOEM_MINUS = bool.Parse(control[i++]); int_2_SendOEM_PERIOD = bool.Parse(control[i++]); int_2_SendOEM_2 = bool.Parse(control[i++]); int_2_SendOEM_3 = bool.Parse(control[i++]); int_2_SendOEM_4 = bool.Parse(control[i++]); int_2_SendOEM_5 = bool.Parse(control[i++]); int_2_SendOEM_6 = bool.Parse(control[i++]); int_2_SendOEM_7 = bool.Parse(control[i++]); int_2_SendOEM_8 = bool.Parse(control[i++]); int_2_SendOEM_102 = bool.Parse(control[i++]); int_2_SendEREOF = bool.Parse(control[i++]); int_2_SendZOOM = bool.Parse(control[i++]); int_2_SendEscape = bool.Parse(control[i++]); int_2_SendOne = bool.Parse(control[i++]); int_2_SendTwo = bool.Parse(control[i++]); int_2_SendThree = bool.Parse(control[i++]); int_2_SendFour = bool.Parse(control[i++]); int_2_SendFive = bool.Parse(control[i++]); int_2_SendSix = bool.Parse(control[i++]); int_2_SendSeven = bool.Parse(control[i++]); int_2_SendEight = bool.Parse(control[i++]); int_2_SendNine = bool.Parse(control[i++]); int_2_SendZero = bool.Parse(control[i++]); int_2_SendDashUnderscore = bool.Parse(control[i++]); int_2_SendPlusEquals = bool.Parse(control[i++]); int_2_SendBackspace = bool.Parse(control[i++]); int_2_SendTab = bool.Parse(control[i++]); int_2_SendOpenBracketBrace = bool.Parse(control[i++]); int_2_SendCloseBracketBrace = bool.Parse(control[i++]); int_2_SendEnter = bool.Parse(control[i++]); int_2_SendControl = bool.Parse(control[i++]); int_2_SendSemicolonColon = bool.Parse(control[i++]); int_2_SendSingleDoubleQuote = bool.Parse(control[i++]); int_2_SendTilde = bool.Parse(control[i++]); int_2_SendLeftShift = bool.Parse(control[i++]); int_2_SendBackslashPipe = bool.Parse(control[i++]); int_2_SendCommaLeftArrow = bool.Parse(control[i++]); int_2_SendPeriodRightArrow = bool.Parse(control[i++]); int_2_SendForwardSlashQuestionMark = bool.Parse(control[i++]); int_2_SendRightShift = bool.Parse(control[i++]); int_2_SendRightAlt = bool.Parse(control[i++]); int_2_SendSpace = bool.Parse(control[i++]); int_2_SendCapsLock = bool.Parse(control[i++]); int_2_SendUp = bool.Parse(control[i++]); int_2_SendDown = bool.Parse(control[i++]); int_2_SendRight = bool.Parse(control[i++]); int_2_SendLeft = bool.Parse(control[i++]); int_2_SendHome = bool.Parse(control[i++]); int_2_SendEnd = bool.Parse(control[i++]); int_2_SendDelete = bool.Parse(control[i++]); int_2_SendPageUp = bool.Parse(control[i++]); int_2_SendPageDown = bool.Parse(control[i++]); int_2_SendInsert = bool.Parse(control[i++]); int_2_SendPrintScreen = bool.Parse(control[i++]); int_2_SendNumLock = bool.Parse(control[i++]); int_2_SendScrollLock = bool.Parse(control[i++]); int_2_SendMenu = bool.Parse(control[i++]); int_2_SendWindowsKey = bool.Parse(control[i++]); int_2_SendNumpadDivide = bool.Parse(control[i++]); int_2_SendNumpadAsterisk = bool.Parse(control[i++]); int_2_SendNumpad7 = bool.Parse(control[i++]); int_2_SendNumpad8 = bool.Parse(control[i++]); int_2_SendNumpad9 = bool.Parse(control[i++]); int_2_SendNumpad4 = bool.Parse(control[i++]); int_2_SendNumpad5 = bool.Parse(control[i++]); int_2_SendNumpad6 = bool.Parse(control[i++]); int_2_SendNumpad1 = bool.Parse(control[i++]); int_2_SendNumpad2 = bool.Parse(control[i++]); int_2_SendNumpad3 = bool.Parse(control[i++]); int_2_SendNumpad0 = bool.Parse(control[i++]); int_2_SendNumpadDelete = bool.Parse(control[i++]); int_2_SendNumpadEnter = bool.Parse(control[i++]); int_2_SendNumpadPlus = bool.Parse(control[i++]); int_2_SendNumpadMinus = bool.Parse(control[i++]);
                valchanged(2, unloadxc);
                if (wd[2] == 1)
                {
                    Scp.UnLoadXC();
                }
                valchanged(3, unloadkm);
                if (wd[3] == 1)
                {
                    SendKeyboard.UnLoadKM();
                }
                valchanged(4, unloadint);
                if (wd[4] == 1)
                {
                    SendInterception.UnLoadKM(input, keyboard_1_id, mouse_1_id, keyboard_2_id, mouse_2_id);
                }
                if (xc)
                {
                    Scp.SetControllers(controller1_send_back, controller1_send_start, controller1_send_A, controller1_send_B, controller1_send_X, controller1_send_Y, controller1_send_up, controller1_send_left, controller1_send_down, controller1_send_right, controller1_send_leftstick, controller1_send_rightstick, controller1_send_leftbumper, controller1_send_rightbumper, controller1_send_lefttrigger, controller1_send_righttrigger, controller1_send_leftstickx, controller1_send_leftsticky, controller1_send_rightstickx, controller1_send_rightsticky, controller2_send_back, controller2_send_start, controller2_send_A, controller2_send_B, controller2_send_X, controller2_send_Y, controller2_send_up, controller2_send_left, controller2_send_down, controller2_send_right, controller2_send_leftstick, controller2_send_rightstick, controller2_send_leftbumper, controller2_send_rightbumper, controller2_send_lefttrigger, controller2_send_righttrigger, controller2_send_leftstickx, controller2_send_leftsticky, controller2_send_rightstickx, controller2_send_rightsticky, controller1_send_lefttriggerposition, controller1_send_righttriggerposition, controller2_send_lefttriggerposition, controller2_send_righttriggerposition, controller1_send_xbox, controller2_send_xbox);
                }
                if (km)
                {
                    SendKeyboard.SetKM(KeyboardMouseDriverType, SendLeftClick, SendRightClick, SendMiddleClick, SendWheelUp, SendWheelDown, SendLeft, SendRight, SendUp, SendDown, SendLButton, SendRButton, SendCancel, SendMBUTTON, SendXBUTTON1, SendXBUTTON2, SendBack, SendTab, SendClear, SendReturn, SendSHIFT, SendCONTROL, SendMENU, SendPAUSE, SendCAPITAL, SendKANA, SendHANGEUL, SendHANGUL, SendJUNJA, SendFINAL, SendHANJA, SendKANJI, SendEscape, SendCONVERT, SendNONCONVERT, SendACCEPT, SendMODECHANGE, SendSpace, SendPRIOR, SendNEXT, SendEND, SendHOME, SendLEFT, SendUP, SendRIGHT, SendDOWN, SendSELECT, SendPRINT, SendEXECUTE, SendSNAPSHOT, SendINSERT, SendDELETE, SendHELP, SendAPOSTROPHE, Send0, Send1, Send2, Send3, Send4, Send5, Send6, Send7, Send8, Send9, SendA, SendB, SendC, SendD, SendE, SendF, SendG, SendH, SendI, SendJ, SendK, SendL, SendM, SendN, SendO, SendP, SendQ, SendR, SendS, SendT, SendU, SendV, SendW, SendX, SendY, SendZ, SendLWIN, SendRWIN, SendAPPS, SendSLEEP, SendNUMPAD0, SendNUMPAD1, SendNUMPAD2, SendNUMPAD3, SendNUMPAD4, SendNUMPAD5, SendNUMPAD6, SendNUMPAD7, SendNUMPAD8, SendNUMPAD9, SendMULTIPLY, SendADD, SendSEPARATOR, SendSUBTRACT, SendDECIMAL, SendDIVIDE, SendF1, SendF2, SendF3, SendF4, SendF5, SendF6, SendF7, SendF8, SendF9, SendF10, SendF11, SendF12, SendF13, SendF14, SendF15, SendF16, SendF17, SendF18, SendF19, SendF20, SendF21, SendF22, SendF23, SendF24, SendNUMLOCK, SendSCROLL, SendLeftShift, SendRightShift, SendLeftControl, SendRightControl, SendLMENU, SendRMENU);
                    SendMouse.SetKM(KeyboardMouseDriverType, MouseMoveX, MouseMoveY, MouseAbsX, MouseAbsY, MouseDesktopX, MouseDesktopY);
                }
                if (interception)
                {
                    if (keyboard_1_id != 0 | mouse_1_id != 0)
                    {
                        SendInterception.SetKM1(MouseDesktopX, MouseDesktopY, input, keyboard_1_id, mouse_1_id, int_1_deltaX, int_1_deltaY, int_1_x, int_1_y, int_1_SendLeftClick, int_1_SendRightClick, int_1_SendMiddleClick, int_1_SendWheelUp, int_1_SendWheelDown, int_1_SendCANCEL, int_1_SendBACK, int_1_SendTAB, int_1_SendCLEAR, int_1_SendRETURN, int_1_SendSHIFT, int_1_SendCONTROL, int_1_SendMENU, int_1_SendCAPITAL, int_1_SendESCAPE, int_1_SendSPACE, int_1_SendPRIOR, int_1_SendNEXT, int_1_SendEND, int_1_SendHOME, int_1_SendLEFT, int_1_SendUP, int_1_SendRIGHT, int_1_SendDOWN, int_1_SendSNAPSHOT, int_1_SendINSERT, int_1_SendNUMPADDEL, int_1_SendNUMPADINSERT, int_1_SendHELP, int_1_SendAPOSTROPHE, int_1_SendBACKSPACE, int_1_SendPAGEDOWN, int_1_SendPAGEUP, int_1_SendFIN, int_1_SendMOUSE, int_1_SendA, int_1_SendB, int_1_SendC, int_1_SendD, int_1_SendE, int_1_SendF, int_1_SendG, int_1_SendH, int_1_SendI, int_1_SendJ, int_1_SendK, int_1_SendL, int_1_SendM, int_1_SendN, int_1_SendO, int_1_SendP, int_1_SendQ, int_1_SendR, int_1_SendS, int_1_SendT, int_1_SendU, int_1_SendV, int_1_SendW, int_1_SendX, int_1_SendY, int_1_SendZ, int_1_SendLWIN, int_1_SendRWIN, int_1_SendAPPS, int_1_SendDELETE, int_1_SendNUMPAD0, int_1_SendNUMPAD1, int_1_SendNUMPAD2, int_1_SendNUMPAD3, int_1_SendNUMPAD4, int_1_SendNUMPAD5, int_1_SendNUMPAD6, int_1_SendNUMPAD7, int_1_SendNUMPAD8, int_1_SendNUMPAD9, int_1_SendMULTIPLY, int_1_SendADD, int_1_SendSUBTRACT, int_1_SendDECIMAL, int_1_SendPRINTSCREEN, int_1_SendDIVIDE, int_1_SendF1, int_1_SendF2, int_1_SendF3, int_1_SendF4, int_1_SendF5, int_1_SendF6, int_1_SendF7, int_1_SendF8, int_1_SendF9, int_1_SendF10, int_1_SendF11, int_1_SendF12, int_1_SendNUMLOCK, int_1_SendSCROLLLOCK, int_1_SendLEFTSHIFT, int_1_SendRIGHTSHIFT, int_1_SendLEFTCONTROL, int_1_SendRIGHTCONTROL, int_1_SendLEFTALT, int_1_SendRIGHTALT, int_1_SendBROWSER_BACK, int_1_SendBROWSER_FORWARD, int_1_SendBROWSER_REFRESH, int_1_SendBROWSER_STOP, int_1_SendBROWSER_SEARCH, int_1_SendBROWSER_FAVORITES, int_1_SendBROWSER_HOME, int_1_SendVOLUME_MUTE, int_1_SendVOLUME_DOWN, int_1_SendVOLUME_UP, int_1_SendMEDIA_NEXT_TRACK, int_1_SendMEDIA_PREV_TRACK, int_1_SendMEDIA_STOP, int_1_SendMEDIA_PLAY_PAUSE, int_1_SendLAUNCH_MAIL, int_1_SendLAUNCH_MEDIA_SELECT, int_1_SendLAUNCH_APP1, int_1_SendLAUNCH_APP2, int_1_SendOEM_1, int_1_SendOEM_PLUS, int_1_SendOEM_COMMA, int_1_SendOEM_MINUS, int_1_SendOEM_PERIOD, int_1_SendOEM_2, int_1_SendOEM_3, int_1_SendOEM_4, int_1_SendOEM_5, int_1_SendOEM_6, int_1_SendOEM_7, int_1_SendOEM_8, int_1_SendOEM_102, int_1_SendEREOF, int_1_SendZOOM, int_1_SendEscape, int_1_SendOne, int_1_SendTwo, int_1_SendThree, int_1_SendFour, int_1_SendFive, int_1_SendSix, int_1_SendSeven, int_1_SendEight, int_1_SendNine, int_1_SendZero, int_1_SendDashUnderscore, int_1_SendPlusEquals, int_1_SendBackspace, int_1_SendTab, int_1_SendOpenBracketBrace, int_1_SendCloseBracketBrace, int_1_SendEnter, int_1_SendControl, int_1_SendSemicolonColon, int_1_SendSingleDoubleQuote, int_1_SendTilde, int_1_SendLeftShift, int_1_SendBackslashPipe, int_1_SendCommaLeftArrow, int_1_SendPeriodRightArrow, int_1_SendForwardSlashQuestionMark, int_1_SendRightShift, int_1_SendRightAlt, int_1_SendSpace, int_1_SendCapsLock, int_1_SendUp, int_1_SendDown, int_1_SendRight, int_1_SendLeft, int_1_SendHome, int_1_SendEnd, int_1_SendDelete, int_1_SendPageUp, int_1_SendPageDown, int_1_SendInsert, int_1_SendPrintScreen, int_1_SendNumLock, int_1_SendScrollLock, int_1_SendMenu, int_1_SendWindowsKey, int_1_SendNumpadDivide, int_1_SendNumpadAsterisk, int_1_SendNumpad7, int_1_SendNumpad8, int_1_SendNumpad9, int_1_SendNumpad4, int_1_SendNumpad5, int_1_SendNumpad6, int_1_SendNumpad1, int_1_SendNumpad2, int_1_SendNumpad3, int_1_SendNumpad0, int_1_SendNumpadDelete, int_1_SendNumpadEnter, int_1_SendNumpadPlus, int_1_SendNumpadMinus);
                    }
                    if (keyboard_2_id != 0 | mouse_2_id != 0)
                    {
                        SendInterception.SetKM2(MouseDesktopX, MouseDesktopY, input, keyboard_2_id, mouse_2_id, int_2_deltaX, int_2_deltaY, int_2_x, int_2_y, int_2_SendLeftClick, int_2_SendRightClick, int_2_SendMiddleClick, int_2_SendWheelUp, int_2_SendWheelDown, int_2_SendCANCEL, int_2_SendBACK, int_2_SendTAB, int_2_SendCLEAR, int_2_SendRETURN, int_2_SendSHIFT, int_2_SendCONTROL, int_2_SendMENU, int_2_SendCAPITAL, int_2_SendESCAPE, int_2_SendSPACE, int_2_SendPRIOR, int_2_SendNEXT, int_2_SendEND, int_2_SendHOME, int_2_SendLEFT, int_2_SendUP, int_2_SendRIGHT, int_2_SendDOWN, int_2_SendSNAPSHOT, int_2_SendINSERT, int_2_SendNUMPADDEL, int_2_SendNUMPADINSERT, int_2_SendHELP, int_2_SendAPOSTROPHE, int_2_SendBACKSPACE, int_2_SendPAGEDOWN, int_2_SendPAGEUP, int_2_SendFIN, int_2_SendMOUSE, int_2_SendA, int_2_SendB, int_2_SendC, int_2_SendD, int_2_SendE, int_2_SendF, int_2_SendG, int_2_SendH, int_2_SendI, int_2_SendJ, int_2_SendK, int_2_SendL, int_2_SendM, int_2_SendN, int_2_SendO, int_2_SendP, int_2_SendQ, int_2_SendR, int_2_SendS, int_2_SendT, int_2_SendU, int_2_SendV, int_2_SendW, int_2_SendX, int_2_SendY, int_2_SendZ, int_2_SendLWIN, int_2_SendRWIN, int_2_SendAPPS, int_2_SendDELETE, int_2_SendNUMPAD0, int_2_SendNUMPAD1, int_2_SendNUMPAD2, int_2_SendNUMPAD3, int_2_SendNUMPAD4, int_2_SendNUMPAD5, int_2_SendNUMPAD6, int_2_SendNUMPAD7, int_2_SendNUMPAD8, int_2_SendNUMPAD9, int_2_SendMULTIPLY, int_2_SendADD, int_2_SendSUBTRACT, int_2_SendDECIMAL, int_2_SendPRINTSCREEN, int_2_SendDIVIDE, int_2_SendF1, int_2_SendF2, int_2_SendF3, int_2_SendF4, int_2_SendF5, int_2_SendF6, int_2_SendF7, int_2_SendF8, int_2_SendF9, int_2_SendF10, int_2_SendF11, int_2_SendF12, int_2_SendNUMLOCK, int_2_SendSCROLLLOCK, int_2_SendLEFTSHIFT, int_2_SendRIGHTSHIFT, int_2_SendLEFTCONTROL, int_2_SendRIGHTCONTROL, int_2_SendLEFTALT, int_2_SendRIGHTALT, int_2_SendBROWSER_BACK, int_2_SendBROWSER_FORWARD, int_2_SendBROWSER_REFRESH, int_2_SendBROWSER_STOP, int_2_SendBROWSER_SEARCH, int_2_SendBROWSER_FAVORITES, int_2_SendBROWSER_HOME, int_2_SendVOLUME_MUTE, int_2_SendVOLUME_DOWN, int_2_SendVOLUME_UP, int_2_SendMEDIA_NEXT_TRACK, int_2_SendMEDIA_PREV_TRACK, int_2_SendMEDIA_STOP, int_2_SendMEDIA_PLAY_PAUSE, int_2_SendLAUNCH_MAIL, int_2_SendLAUNCH_MEDIA_SELECT, int_2_SendLAUNCH_APP1, int_2_SendLAUNCH_APP2, int_2_SendOEM_1, int_2_SendOEM_PLUS, int_2_SendOEM_COMMA, int_2_SendOEM_MINUS, int_2_SendOEM_PERIOD, int_2_SendOEM_2, int_2_SendOEM_3, int_2_SendOEM_4, int_2_SendOEM_5, int_2_SendOEM_6, int_2_SendOEM_7, int_2_SendOEM_8, int_2_SendOEM_102, int_2_SendEREOF, int_2_SendZOOM, int_2_SendEscape, int_2_SendOne, int_2_SendTwo, int_2_SendThree, int_2_SendFour, int_2_SendFive, int_2_SendSix, int_2_SendSeven, int_2_SendEight, int_2_SendNine, int_2_SendZero, int_2_SendDashUnderscore, int_2_SendPlusEquals, int_2_SendBackspace, int_2_SendTab, int_2_SendOpenBracketBrace, int_2_SendCloseBracketBrace, int_2_SendEnter, int_2_SendControl, int_2_SendSemicolonColon, int_2_SendSingleDoubleQuote, int_2_SendTilde, int_2_SendLeftShift, int_2_SendBackslashPipe, int_2_SendCommaLeftArrow, int_2_SendPeriodRightArrow, int_2_SendForwardSlashQuestionMark, int_2_SendRightShift, int_2_SendRightAlt, int_2_SendSpace, int_2_SendCapsLock, int_2_SendUp, int_2_SendDown, int_2_SendRight, int_2_SendLeft, int_2_SendHome, int_2_SendEnd, int_2_SendDelete, int_2_SendPageUp, int_2_SendPageDown, int_2_SendInsert, int_2_SendPrintScreen, int_2_SendNumLock, int_2_SendScrollLock, int_2_SendMenu, int_2_SendWindowsKey, int_2_SendNumpadDivide, int_2_SendNumpadAsterisk, int_2_SendNumpad7, int_2_SendNumpad8, int_2_SendNumpad9, int_2_SendNumpad4, int_2_SendNumpad5, int_2_SendNumpad6, int_2_SendNumpad1, int_2_SendNumpad2, int_2_SendNumpad3, int_2_SendNumpad0, int_2_SendNumpadDelete, int_2_SendNumpadEnter, int_2_SendNumpadPlus, int_2_SendNumpadMinus);
                    }
                }
            }
            catch { }
        }
        public static string[] byteArrayToControl(byte[] byteArrayIn)
        {
            string str = Encoding.ASCII.GetString(byteArrayIn);
            string[] splitstring = str.Split(',');
            List<string> newsplitstring = new List<string>();
            foreach (string valuestring in splitstring)
            {
                int pFrom = valuestring.IndexOf(".");
                string newvaluestring;
                if (pFrom > 0)
                {
                    int pTo = valuestring.Length;
                    string result = valuestring.Substring(pFrom, pTo - pFrom);
                    newvaluestring = valuestring.Replace(result, "");
                }
                else
                {
                    newvaluestring = valuestring;
                }
                newsplitstring.Add(newvaluestring);
            }
            return newsplitstring.ToArray();
        }
        private void Form1_FormClosing(object sender, FormClosingEventArgs e)
        {
            running = false;
            System.Threading.Thread.Sleep(300);
            using (System.IO.StreamWriter createdfile = new System.IO.StreamWriter("tempsave"))
            {
                createdfile.WriteLine(textBox1.Text);
                createdfile.WriteLine(textBox2.Text);
            }
            input.Unload();
        }
    }
}